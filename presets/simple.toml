[header]
version = "1.0"
required_extensions = [
    "dbankier.vscode-quick-select",
    "haberdashPI.vscode-select-by-indent",
    "haberdashPI.selection-utilities",
    "haberdashPI.move-cursor-by-argument",
    "pustelto.bracketeer",
    "wmaurer.change-case",
    "pranshuagrawal.toggle-case",
    "albymor.increment-selection",
    "pkief.markdown-checkbox",
    "edgardmessias.clipboard-manager",
    "stkb.rewrap",
    "haberdashPI.terminal-polyglot",
    "jack89ita.open-file-from-path",
    "koalamer.labeled-bookmarks",
]

[bind]
name = "Ben's Key Bindings"

description = """
Keybindings for Ben :)
"""
[define]
validModes = ["insert", "normal", "surround", "search"]

[define.symmetric_key_map]
"shift+;" = ":"
"shift+'" = "\""
"shift+/" = "?"
"shift+\\" = "|"
"shift+=" = "+"
"shift+-" = "-"
"shift+8" = "*"
"shift+7" = "&"
"shift+6" = "^"
"shift+5" = "%"
"shift+4" = "$"
"shift+3" = "#"
"shift+2" = "@"
"shift+1" = "!"
"shift+`" = "~"
";" = ";"
"'" = "'"
"," = ","
"." = "."
"/" = "/"
"=" = "="
"-" = "-"
"`" = "`"

[define.key_to_select_inside_command]
"'" = "bracketeer.selectQuotesContent"
"shift+'" = "bracketeer.selectQuotesContent"
"x" = "bracketeer.selectBracketContent"

[bind.fffaults]
name = "Defaults"
description = """
These keybinds are applied first and will be overridden by any binds found in other
config files.
"""

[[bind.fffaults.items]]
# by default typing keys in a mode other than insert is simply ignored
name = "ignore"
description = "this key does nothing"
key = ["<all-keys>", "shift+<all-keys>"]
do.command = "modalkeys.ignore"
allowed_prefixes = "<all-prefixes>"
mode = ["!insert", "!search"]
when = "editorTextFocus && !findWidgetVisible"

[bind.edit]
name = "Edit"
description = ""

[bind.edit.action]
name = "Edit Actions"
description = "Collection of actions for editing text"

[bind.edit.action.surround]
name = "Surround"
description = "Actions for modifying surrounding characters"

[[bind.edit.action.surround.items]]
name = "normal"
description = "Enter normal mode"
key = ["escape", "ctrl+["]
when = "editorTextFocus && !findWidgetVisible"
do = ["modalkeys.enterNormal", "modalkeys.reset"]

[[bind.edit.action.surround.items]]
name = "insert"
description = "Enter insert mode"
key = ["i"]
mode = "normal"
when = "editorTextFocus && !findWidgetVisible"
do = ["modalkeys.enterInsert", "modalkeys.reset"]

[[bind.edit.action.surround.items]]
name = "Enter surround mode"
description = "change surrounding characters"
when = "!editorHasSelection"
key = "c s"
mode = "normal"
do.command = "modalkeys.enterMode"
do.args.mode = "surround"

[[bind.edit.action.surround.items]]
name = "change surround"
description = "change surround"
mode = ["surround"]
key = ["'", "shift+'", "["]
allowed_prefixes = ['']
do = [
  {command = 'modalkeys.prefix', args = { key = "{key}"}},
  {command = 'modalkeys.log', args = { value = 'printing from log'}},
]
resetTransient = false

[[bind.edit.action.surround.items]]
name = "change surround"
description = "change surround"
mode = ['surround']
key = ["'", "shift+'"]
allowed_prefixes = ["'", "shift+'"]
do = [
  {command = 'modalkeys.log', args = { value = 'followup'}},
  "{key_to_select_inside_command[prefix]}", 
  { command = 'selection-utilities.deleteAround', args = { count = 1}},
  { command = 'selection-utilities.insertAround', args = {before = '{symmetric_key_map[key]}', after = '{symmetric_key_map[key]}'}},
  "modalkeys.enterNormal",
]